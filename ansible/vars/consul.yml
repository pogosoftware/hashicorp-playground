---
consul_version: 1.16.2

consul_domain: consul
consul_datacenter: dc1

consul_user: consul
consul_group: consul

consul_config_path: /etc/consul.d
consul_path: /var/lib/consul
consul_data_path: "{{ consul_path }}/data"
consul_logs_path: "{{ consul_path }}/logs"
consul_tls_path: "{{ consul_path }}/tls"

consul_bin_path: /usr/local/bin
consul_binary_file_path: "{{ consul_bin_path }}/consul"
consul_service_path: /etc/systemd/system

consul_ca_certificate_file_path: "{{ consul_tls_path }}/consul.{{ consul_datacenter }}.{{ consul_domain }}-ca.crt"
consul_agent_certificate_file_path: "{{ consul_tls_path }}/agent.{{ consul_datacenter }}.{{ consul_domain }}.crt"
consul_agent_certificate_key_file_path: "{{ consul_tls_path }}/agent.{{ consul_datacenter }}.{{ consul_domain }}.key"

consul_cli_path: "{{ item.home_dir }}/.consul"
consul_cli_ca_certificate_file_path: "{{ consul_cli_path }}/consul.{{ consul_datacenter }}.{{ consul_domain }}-ca.crt"
consul_cli_certificate_file_path: "{{ consul_cli_path }}/{{ item.name }}.{{ consul_datacenter }}.{{ consul_domain }}.crt"
consul_cli_certificate_key_file_path: "{{ consul_cli_path }}/{{ item.name }}.{{ consul_datacenter }}.{{ consul_domain }}.key"

consul_secret_root_path: "{{ common_secret_root_path }}/consul"
consul_gossip_encryption_key_file_path: "{{ consul_secret_root_path }}/gossip_encryption_key"
consul_boostrap_acl_token_file_path: "{{ consul_secret_root_path }}/bootstrap_token"

consul_token_path: "{{ consul_secret_root_path }}/tokens/{{ ansible_hostname }}"
consul_agent_token_file_path: "{{ consul_token_path }}/agent_consul_token"
consul_dns_requests_token_file_path: "{{ consul_token_path }}/dns_requests_consul_token"

consul_policies:
  - name: consul-agent
    description: 'Consul Agent token'
    src: files/consul/agent-policy.hcl
    dest: /tmp/agent-policy.hcl
  - name: dns-requests
    description: 'Token for DNS Requests'
    src: files/consul/dns-request-policy.hcl
    dest: /tmp/dns-request-policy.hcl
